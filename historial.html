<!DOCTYPE html>
<html>
<head>
    <title>Historial - SQL Store</title>
    <link rel="stylesheet" href="css/estilos.css">
    <script src="js/app.js"></script>
</head>
<body onload="actualizarBadge()">

<header>
    <h2><a href="index.html">SQL Store</a></h2>
    <div>
        <a href="historial.html">Historial</a>
        <a href="carrito.html">
            ðŸ›’ <span id="cartCount" class="cart-badge" style="display:none;"></span>
        </a>
    </div>
</header>

<div class="container">

    <h1>Historial de Compras</h1>

    <input id="emailBuscar" placeholder="Ingrese su correo">
    <button onclick="buscarHistorial()">Buscar</button>

    <hr>

    <div id="resultado"></div>

</div>

<script>

async function buscarHistorial() {

    const email = document.getElementById("emailBuscar").value;

    if (!email) {
        alert("Ingrese un correo");
        return;
    }

    const res = await fetch(`http://localhost:3000/historial/${email}`);
    const data = await res.json();

    const cont = document.getElementById("resultado");
    cont.innerHTML = "";

    if (data.length === 0) {
        cont.innerHTML = "<p>No se encontraron compras.</p>";
        return;
    }

    data.forEach(v => {
        cont.innerHTML += `
            <div style="background:white;padding:15px;margin-bottom:10px;border-radius:8px;">
                <strong>Venta #${v.IdVenta}</strong><br>
                Fecha: ${new Date(v.Fecha).toLocaleString()}<br>
                Total: $${v.Total}
            </div>
        `;
    });
}

</script>

</body>
</html>